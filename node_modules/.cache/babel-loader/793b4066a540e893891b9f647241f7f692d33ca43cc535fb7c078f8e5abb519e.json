{"ast":null,"code":"var _jsxFileName = \"/Users/mariogijon/Desktop/Mario/git/reservasPadel/src/components/CancelReservation.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { supabase } from '../lib/supabaseClient';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CancelReservation = () => {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [reservation, setReservation] = useState(null);\n  const location = useLocation();\n  useEffect(() => {\n    const params = new URLSearchParams(location.search);\n    const codigo = params.get('codigo');\n    if (codigo) {\n      fetchReservation(codigo);\n    } else {\n      setMessage('Código de cancelación no válido');\n    }\n  }, [location]);\n  const fetchReservation = async codigo => {\n    try {\n      const {\n        data,\n        error\n      } = await supabase.from('reservas').select('*').eq('codigo_cancelacion', codigo).eq('status', 'activa').single();\n      if (error) throw error;\n      if (data) {\n        setReservation(data);\n      } else {\n        setMessage('Reserva no encontrada o ya cancelada');\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      setMessage('Reserva no encontrada o ya cancelada');\n    }\n  };\n  const handleCancel = async () => {\n    if (!reservation) return;\n    setLoading(true);\n    try {\n      const {\n        error\n      } = await supabase.from('reservas').update({\n        status: 'cancelada'\n      }).eq('id', reservation.id);\n      if (error) throw error;\n      setMessage('✓ Reserva cancelada correctamente');\n      setReservation(null);\n    } catch (error) {\n      console.error('Error canceling reservation:', error);\n      setMessage('Error al cancelar la reserva. Por favor, inténtalo de nuevo.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"cancel-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Cancelar Reserva\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `message ${message.includes('✓') ? 'success' : 'error'}`,\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this), reservation && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reservation-details\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Detalles de la Reserva\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Fecha:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 14\n        }, this), \" \", reservation.fecha]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Hora:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 14\n        }, this), \" \", reservation.hora_inicio]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Nombre:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 14\n        }, this), \" \", reservation.nombre, \" \", reservation.apellidos]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Portal:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 14\n        }, this), \" \", reservation.portal, \" - \", reservation.piso, reservation.letra]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cancel-actions\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCancel,\n          className: \"btn-cancel-confirm\",\n          disabled: loading,\n          children: loading ? 'Cancelando...' : 'Confirmar Cancelación'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n_s(CancelReservation, \"tDPCwS4eqNHRz/xL8xhFNgREBPw=\", false, function () {\n  return [useLocation];\n});\n_c = CancelReservation;\nexport default CancelReservation;\nvar _c;\n$RefreshReg$(_c, \"CancelReservation\");","map":{"version":3,"names":["React","useState","useEffect","useLocation","supabase","jsxDEV","_jsxDEV","CancelReservation","_s","loading","setLoading","message","setMessage","reservation","setReservation","location","params","URLSearchParams","search","codigo","get","fetchReservation","data","error","from","select","eq","single","console","handleCancel","update","status","id","className","children","fileName","_jsxFileName","lineNumber","columnNumber","includes","fecha","hora_inicio","nombre","apellidos","portal","piso","letra","onClick","disabled","_c","$RefreshReg$"],"sources":["/Users/mariogijon/Desktop/Mario/git/reservasPadel/src/components/CancelReservation.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { supabase } from '../lib/supabaseClient';\n\nconst CancelReservation = () => {\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [reservation, setReservation] = useState(null);\n  const location = useLocation();\n\n  useEffect(() => {\n    const params = new URLSearchParams(location.search);\n    const codigo = params.get('codigo');\n    \n    if (codigo) {\n      fetchReservation(codigo);\n    } else {\n      setMessage('Código de cancelación no válido');\n    }\n  }, [location]);\n\n  const fetchReservation = async (codigo) => {\n    try {\n      const { data, error } = await supabase\n        .from('reservas')\n        .select('*')\n        .eq('codigo_cancelacion', codigo)\n        .eq('status', 'activa')\n        .single();\n\n      if (error) throw error;\n      \n      if (data) {\n        setReservation(data);\n      } else {\n        setMessage('Reserva no encontrada o ya cancelada');\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      setMessage('Reserva no encontrada o ya cancelada');\n    }\n  };\n\n  const handleCancel = async () => {\n    if (!reservation) return;\n\n    setLoading(true);\n\n    try {\n      const { error } = await supabase\n        .from('reservas')\n        .update({ status: 'cancelada' })\n        .eq('id', reservation.id);\n\n      if (error) throw error;\n\n      setMessage('✓ Reserva cancelada correctamente');\n      setReservation(null);\n    } catch (error) {\n      console.error('Error canceling reservation:', error);\n      setMessage('Error al cancelar la reserva. Por favor, inténtalo de nuevo.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"cancel-container\">\n      <h2>Cancelar Reserva</h2>\n      \n      {message && (\n        <div className={`message ${message.includes('✓') ? 'success' : 'error'}`}>\n          {message}\n        </div>\n      )}\n\n      {reservation && (\n        <div className=\"reservation-details\">\n          <h3>Detalles de la Reserva</h3>\n          <p><strong>Fecha:</strong> {reservation.fecha}</p>\n          <p><strong>Hora:</strong> {reservation.hora_inicio}</p>\n          <p><strong>Nombre:</strong> {reservation.nombre} {reservation.apellidos}</p>\n          <p><strong>Portal:</strong> {reservation.portal} - {reservation.piso}{reservation.letra}</p>\n          \n          <div className=\"cancel-actions\">\n            <button \n              onClick={handleCancel} \n              className=\"btn-cancel-confirm\"\n              disabled={loading}\n            >\n              {loading ? 'Cancelando...' : 'Confirmar Cancelación'}\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CancelReservation;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}